{
	"name": "102_GR03_DF_Transform_Data",
	"properties": {
		"folder": {
			"name": "102_GR03"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "102_GR03_DS_ProdConsElec_RAW",
						"type": "DatasetReference"
					},
					"name": "ProdConsElecProcessed"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "102_GR03_DS_ProdConsElec_PROCESSED",
						"type": "DatasetReference"
					},
					"name": "SinkProdConsElec"
				}
			],
			"transformations": [
				{
					"name": "SelectProdConsElec"
				}
			],
			"scriptLines": [
				"source(output(",
				"          iso_code as string,",
				"          country as string,",
				"          year as string,",
				"          coal_prod_change_pct as string,",
				"          coal_prod_change_twh as string,",
				"          gas_prod_change_pct as string,",
				"          gas_prod_change_twh as string,",
				"          oil_prod_change_pct as string,",
				"          oil_prod_change_twh as string,",
				"          energy_cons_change_pct as string,",
				"          energy_cons_change_twh as string,",
				"          biofuel_share_elec as string,",
				"          biofuel_elec_per_capita as string,",
				"          biofuel_cons_change_pct as string,",
				"          biofuel_share_energy as string,",
				"          biofuel_cons_change_twh as string,",
				"          biofuel_consumption as string,",
				"          biofuel_cons_per_capita as string,",
				"          carbon_intensity_elec as string,",
				"          coal_share_elec as string,",
				"          coal_cons_change_pct as string,",
				"          coal_share_energy as string,",
				"          coal_cons_change_twh as string,",
				"          coal_consumption as string,",
				"          coal_elec_per_capita as string,",
				"          coal_cons_per_capita as string,",
				"          coal_production as string,",
				"          coal_prod_per_capita as string,",
				"          electricity_demand as string,",
				"          biofuel_electricity as string,",
				"          coal_electricity as string,",
				"          fossil_electricity as string,",
				"          gas_electricity as string,",
				"          hydro_electricity as string,",
				"          nuclear_electricity as string,",
				"          oil_electricity as string,",
				"          other_renewable_exc_biofuel_electricity as string,",
				"          other_renewable_electricity as string,",
				"          renewables_electricity as string,",
				"          solar_electricity as string,",
				"          wind_electricity as string,",
				"          electricity_generation as string,",
				"          greenhouse_gas_emissions as string,",
				"          energy_per_gdp as string,",
				"          energy_per_capita as string,",
				"          fossil_cons_change_pct as string,",
				"          fossil_share_energy as string,",
				"          fossil_cons_change_twh as string,",
				"          fossil_fuel_consumption as string,",
				"          fossil_energy_per_capita as string,",
				"          fossil_cons_per_capita as string,",
				"          fossil_share_elec as string,",
				"          gdp as string,",
				"          gas_share_elec as string,",
				"          gas_cons_change_pct as string,",
				"          gas_share_energy as string,",
				"          gas_cons_change_twh as string,",
				"          gas_consumption as string,",
				"          gas_elec_per_capita as string,",
				"          gas_energy_per_capita as string,",
				"          gas_production as string,",
				"          gas_prod_per_capita as string,",
				"          hydro_share_elec as string,",
				"          hydro_cons_change_pct as string,",
				"          hydro_share_energy as string,",
				"          hydro_cons_change_twh as string,",
				"          hydro_consumption as string,",
				"          hydro_elec_per_capita as string,",
				"          hydro_energy_per_capita as string,",
				"          low_carbon_share_elec as string,",
				"          low_carbon_electricity as string,",
				"          low_carbon_elec_per_capita as string,",
				"          low_carbon_cons_change_pct as string,",
				"          low_carbon_share_energy as string,",
				"          low_carbon_cons_change_twh as string,",
				"          low_carbon_consumption as string,",
				"          low_carbon_energy_per_capita as string,",
				"          net_elec_imports_share_demand as string,",
				"          net_elec_imports as string,",
				"          nuclear_share_elec as string,",
				"          nuclear_cons_change_pct as string,",
				"          nuclear_share_energy as string,",
				"          nuclear_cons_change_twh as string,",
				"          nuclear_consumption as string,",
				"          nuclear_elec_per_capita as string,",
				"          nuclear_energy_per_capita as string,",
				"          oil_share_elec as string,",
				"          oil_cons_change_pct as string,",
				"          oil_share_energy as string,",
				"          oil_cons_change_twh as string,",
				"          oil_consumption as string,",
				"          oil_elec_per_capita as string,",
				"          oil_energy_per_capita as string,",
				"          oil_production as string,",
				"          oil_prod_per_capita as string,",
				"          other_renewables_elec_per_capita_exc_biofuel as string,",
				"          other_renewables_elec_per_capita as string,",
				"          other_renewables_cons_change_pct as string,",
				"          other_renewables_share_energy as string,",
				"          other_renewables_cons_change_twh as string,",
				"          other_renewable_consumption as string,",
				"          other_renewables_share_elec_exc_biofuel as string,",
				"          other_renewables_share_elec as string,",
				"          other_renewables_energy_per_capita as string,",
				"          per_capita_electricity as string,",
				"          population as string,",
				"          primary_energy_consumption as string,",
				"          renewables_elec_per_capita as string,",
				"          renewables_share_elec as string,",
				"          renewables_cons_change_pct as string,",
				"          renewables_share_energy as string,",
				"          renewables_cons_change_twh as string,",
				"          renewables_consumption as string,",
				"          renewables_energy_per_capita as string,",
				"          solar_share_elec as string,",
				"          solar_cons_change_pct as string,",
				"          solar_share_energy as string,",
				"          solar_cons_change_twh as string,",
				"          solar_consumption as string,",
				"          solar_elec_per_capita as string,",
				"          solar_energy_per_capita as string,",
				"          wind_share_elec as string,",
				"          wind_cons_change_pct as string,",
				"          wind_share_energy as string,",
				"          wind_cons_change_twh as string,",
				"          wind_consumption as string,",
				"          wind_elec_per_capita as string,",
				"          wind_energy_per_capita as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ProdConsElecProcessed",
				"ProdConsElecProcessed select(mapColumn(",
				"          {Cod 3} = iso_code,",
				"          {País} = country,",
				"          Ano = year,",
				"          {Consumo Biofuel} = biofuel_consumption,",
				"          {Emissões CO2} = carbon_intensity_elec,",
				"          {Consumo Carvão} = coal_consumption,",
				"          {Produção Biofuel} = biofuel_electricity,",
				"          {Produção Carvão} = coal_electricity,",
				"          {Produção Gás Natural} = gas_electricity,",
				"          {Produção Hidro} = hydro_electricity,",
				"          {Produção Nuclear} = nuclear_electricity,",
				"          {Produção Petrólio} = oil_electricity,",
				"          {Produção Outras Renováveis} = other_renewable_exc_biofuel_electricity,",
				"          {Produção Solar} = solar_electricity,",
				"          {Produção Eólica} = wind_electricity,",
				"          PIB = gdp,",
				"          {Consumo Gás Natural} = gas_consumption,",
				"          {Consumo Hidro} = hydro_consumption,",
				"          {Consumo Nuclear} = nuclear_consumption,",
				"          {Consumo Petrólio} = oil_consumption,",
				"          {Consumo Outras Renováveis} = other_renewable_consumption,",
				"          {População} = population,",
				"          {Consumo Solar} = solar_consumption,",
				"          {Consumo Eólica} = wind_consumption",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectProdConsElec",
				"SelectProdConsElec sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          {Report generated on: 04-19-2022 19:43:28} as string",
				"     ),",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SinkProdConsElec"
			]
		}
	}
}